"use strict";let results=[],favs=[];paintFavs();const searchButton=document.querySelector(".js-search-form__button");function readInput(e){e.preventDefault();makeRequest(document.querySelector(".js-search-form__input").value)}function makeRequest(e){fetch("http://api.tvmaze.com/search/shows?q="+e).then((function(e){return e.json()})).then((function(e){results=e,paintResults()}))}function paintResults(){const e=document.querySelector(".js-results-list");e.innerHTML="",addSectionTitle("results");for(const t of results){let n=createCard(e,t);checkIfNeedsHighlight(n),n.addEventListener("click",checkIsFav)}}function addSectionTitle(e){document.querySelector(`.${e}-list__title`).classList.remove("hidden")}function createCard(e,t){const n=document.createElement("li");e.appendChild(n),n.setAttribute("id",t.show.id);const s=document.createElement("img");n.appendChild(s),t.show.image?s.src=t.show.image.medium:s.src="https://via.placeholder.com/210x295/ffffff/666666/?text=TV";const a=document.createElement("h3");return n.appendChild(a),a.innerHTML=t.show.name,n}function checkIfNeedsHighlight(e){favs.find(t=>t.show.id===parseInt(e.id))&&e.classList.add("yellow-background")}function checkIsFav(e){let t=document.getElementById(e.currentTarget.id);const n=parseInt(t.id);favs.find(e=>e.show.id===n)?deleteFav(n):saveAsFav(n)}function saveAsFav(e){const t=results.find(t=>t.show.id===parseInt(e));favs.push(t),updateLocalStorage(),paintFavs(),paintResults()}function paintFavs(){const e=JSON.parse(localStorage.getItem("favShows"));if(!e)return;favs=e,addSectionTitle("favs"),addDeleteAllButton();const t=document.querySelector(".js-favs-list");t.innerHTML="";for(let n=0;n<e.length;n++){addDeleteIcon(createCard(t,e[n]))}listenToDeleteAllButton()}function updateLocalStorage(){localStorage.setItem("favShows",JSON.stringify(favs))}function addDeleteIcon(e){const t=document.createElement("i");t.setAttribute("class","fa fa-times-circle fa-2x js-delete-icon"),e.appendChild(t),t.addEventListener("click",getClickedItemId)}function getClickedItemId(e){const t=document.getElementById(e.currentTarget.parentElement.id);deleteFav(parseInt(t.id))}function deleteFav(e){const t=favs.findIndex(t=>t.show.id===e);favs.splice(t,1),updateLocalStorage(),paintFavs(),paintResults()}function deleteAllFavs(e){e.preventDefault(),favs=[],updateLocalStorage(),paintFavs(),paintResults()}function addDeleteAllButton(){const e=document.querySelector(".js-favs-list__delete-button");0===favs.length?e.classList.add("hidden"):e.classList.remove("hidden")}function listenToDeleteAllButton(){document.querySelector(".js-favs-list__delete-button").addEventListener("click",deleteAllFavs)}searchButton.addEventListener("click",readInput);